- job-template:
    name: 'qe-rhel-6-trigger'
    node: master
    triggers:
      - pollurl:
          cron: 'H/9 * * * *'
          urls:
            - url: http://download.eng.rdu2.redhat.com/rel-eng/latest-RHEL-6/COMPOSE_ID
              check-content:
                - simple: true
    builders:
        - shell: |
            #!/bin/bash
            RHEL_COMPOSE=`curl -s -k http://download.eng.rdu2.redhat.com/rel-eng/latest-RHEL-6/COMPOSE_ID`
            echo "*********************************setup env*********************************"
            #setup environment here to run alone, change back when finished
            #export RHEL_COMPOSE=
            echo "*********************************setup env*********************************"
            echo RHEL_COMPOSE=$RHEL_COMPOSE > BUILD.txt
        - inject:
            properties-file: $WORKSPACE/BUILD.txt
    publishers:
      - archive:
          artifacts: '*.txt, *.json'
          allow-empty: 'true'
      - trigger-parameterized-builds:
          - project: 'qeos-satellite-install-rhel-6-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'sam-install-for-rhel-6-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'virt-who-pxe-create-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'rhsm-stage-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'virt-who-stage-kvm-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
      - default-virt-who-publishers

- job-template:
    name: 'qe-rhel-7-trigger'
    node: master
    triggers:
      - pollurl:
          cron: 'H/9 * * * *'
          urls:
            - url: http://download.eng.rdu2.redhat.com/rel-eng/latest-RHEL-7/COMPOSE_ID
              check-content:
                - simple: true
    builders:
        - shell: |
            #!/bin/bash
            RHEL_COMPOSE=`curl -s -k http://download.eng.rdu2.redhat.com/rel-eng/latest-RHEL-7/COMPOSE_ID`
            echo "*********************************setup env*********************************"
            #setup environment here to run alone, change back when finished
            #export RHEL_COMPOSE=
            echo "*********************************setup env*********************************"
            echo RHEL_COMPOSE=$RHEL_COMPOSE > BUILD.txt
        - inject:
            properties-file: $WORKSPACE/BUILD.txt
    publishers:
      - archive:
          artifacts: '*.txt, *.json'
          allow-empty: 'true'
      - trigger-parameterized-builds:
          - project: 'qeos-satellite-install-rhel-7-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'sam-install-for-rhel-7-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'virt-who-pxe-create-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'rhsm-stage-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'virt-who-stage-kvm-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
      - default-virt-who-publishers

- job-template:
    name: 'qe-sam-1-4-trigger'
    node: master
    triggers:
      - pollurl:
          cron: 'H/9 * * * *'
          urls:
            - url: http://download.devel.redhat.com/devel/candidate-trees/SAM/latest-SAM-1.4-RHEL-6/COMPOSE_ID
              check-content:
                - simple: true
    builders:
        - shell: |
            #!/bin/bash
            compose=`curl -s -k http://download.devel.redhat.com/devel/candidate-trees/SAM/latest-SAM-1.4-RHEL-6/COMPOSE_ID`
            echo SAM_COMPOSE=$compose > BUILD.txt
        - inject:
            properties-file: $WORKSPACE/BUILD.txt
    publishers:
      - archive:
          artifacts: '*.txt, *.json'
          allow-empty: 'true'
      - trigger-parameterized-builds:
          - project: 'sam-install-for-rhel-7-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'rhsm-stage-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
      - default-virt-who-publishers

- job-template:
    name: 'qe-satellite-6-1-trigger'
    node: master
    triggers:
      - pollurl:
          cron: 'H/9 * * * *'
          urls:
            - url: http://satellite6.lab.eng.rdu2.redhat.com/devel/candidate-trees/Satellite/latest-stable-Satellite-6.1-RHEL-7/COMPOSE_ID
              check-content:
                - simple: true
    builders:
        - shell: |
            #!/bin/bash
            compose=`curl -s -k http://satellite6.lab.eng.rdu2.redhat.com/devel/candidate-trees/Satellite/latest-stable-Satellite-6.1-RHEL-7/COMPOSE_ID`
            echo SATELLITE_COMPOSE=$compose > BUILD.txt
        - inject:
            properties-file: $WORKSPACE/BUILD.txt
    publishers:
      - archive:
          artifacts: '*.txt, *.json'
          allow-empty: 'true'
      - trigger-parameterized-builds:
          - project: 'qeos-satellite-install-rhel-7-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
          - project: 'rhsm-stage-provision'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: $WORKSPACE/BUILD.txt
      - default-virt-who-publishers

- job-group:
    name: qe-triggers
    jobs:
      - 'qe-rhel-6-trigger'
      - 'qe-rhel-7-trigger'
      - 'qe-sam-1-4-trigger'
      - 'qe-satellite-6-1-trigger'

- project:
    name: qe-triggers-jobs
    project: qe-triggers
    jobs:
      - qe-triggers
